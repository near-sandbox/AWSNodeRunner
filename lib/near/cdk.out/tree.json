{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.222.0"},"children":{"near-common":{"id":"near-common","path":"near-common","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.222.0"},"children":{"NearVpc":{"id":"NearVpc","path":"near-common/NearVpc","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-common/NearVpc/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"PublicSubnet1":{"id":"PublicSubnet1","path":"near-common/NearVpc/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.222.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"near-common/NearVpc/PublicSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1a","cidrBlock":"10.0.0.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"near-common/NearVpc/PublicSubnet1"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"Acl":{"id":"Acl","path":"near-common/NearVpc/PublicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"near-common/NearVpc/PublicSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc/PublicSubnet1"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"near-common/NearVpc/PublicSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"NearVpcPublicSubnet1RouteTable747F7DDB"},"subnetId":{"Ref":"NearVpcPublicSubnet1SubnetD881C8CB"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"near-common/NearVpc/PublicSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"NearVpcIGWE15063E9"},"routeTableId":{"Ref":"NearVpcPublicSubnet1RouteTable747F7DDB"}}}},"EIP":{"id":"EIP","path":"near-common/NearVpc/PublicSubnet1/EIP","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIP","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIP","aws:cdk:cloudformation:props":{"domain":"vpc","tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc/PublicSubnet1"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"NATGateway":{"id":"NATGateway","path":"near-common/NearVpc/PublicSubnet1/NATGateway","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnNatGateway","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::NatGateway","aws:cdk:cloudformation:props":{"allocationId":{"Fn::GetAtt":["NearVpcPublicSubnet1EIPB6C33299","AllocationId"]},"subnetId":{"Ref":"NearVpcPublicSubnet1SubnetD881C8CB"},"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc/PublicSubnet1"},{"key":"Project","value":"AWSNearLocalnet"}]}}}}},"PublicSubnet2":{"id":"PublicSubnet2","path":"near-common/NearVpc/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.222.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"near-common/NearVpc/PublicSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1b","cidrBlock":"10.0.64.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"near-common/NearVpc/PublicSubnet2"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"Acl":{"id":"Acl","path":"near-common/NearVpc/PublicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"near-common/NearVpc/PublicSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc/PublicSubnet2"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"near-common/NearVpc/PublicSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"NearVpcPublicSubnet2RouteTable76BF65CA"},"subnetId":{"Ref":"NearVpcPublicSubnet2SubnetB04D0CC4"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"near-common/NearVpc/PublicSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"NearVpcIGWE15063E9"},"routeTableId":{"Ref":"NearVpcPublicSubnet2RouteTable76BF65CA"}}}}}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"near-common/NearVpc/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.222.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"near-common/NearVpc/PrivateSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1a","cidrBlock":"10.0.128.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"near-common/NearVpc/PrivateSubnet1"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"Acl":{"id":"Acl","path":"near-common/NearVpc/PrivateSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"near-common/NearVpc/PrivateSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc/PrivateSubnet1"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"near-common/NearVpc/PrivateSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"NearVpcPrivateSubnet1RouteTable4251C15C"},"subnetId":{"Ref":"NearVpcPrivateSubnet1SubnetE647D3D1"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"near-common/NearVpc/PrivateSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"NearVpcPublicSubnet1NATGateway46691DD0"},"routeTableId":{"Ref":"NearVpcPrivateSubnet1RouteTable4251C15C"}}}}}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"near-common/NearVpc/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.222.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"near-common/NearVpc/PrivateSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1b","cidrBlock":"10.0.192.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"near-common/NearVpc/PrivateSubnet2"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"Acl":{"id":"Acl","path":"near-common/NearVpc/PrivateSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"near-common/NearVpc/PrivateSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc/PrivateSubnet2"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"near-common/NearVpc/PrivateSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"NearVpcPrivateSubnet2RouteTable856E0B03"},"subnetId":{"Ref":"NearVpcPrivateSubnet2SubnetDDB4FE3B"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"near-common/NearVpc/PrivateSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"NearVpcPublicSubnet1NATGateway46691DD0"},"routeTableId":{"Ref":"NearVpcPrivateSubnet2RouteTable856E0B03"}}}}}},"IGW":{"id":"IGW","path":"near-common/NearVpc/IGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"VPCGW":{"id":"VPCGW","path":"near-common/NearVpc/VPCGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"NearVpcIGWE15063E9"},"vpcId":{"Ref":"NearVpc17ED9B68"}}}},"SSMEndpoint":{"id":"SSMEndpoint","path":"near-common/NearVpc/SSMEndpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.222.0","metadata":[]},"children":{"SecurityGroup":{"id":"SecurityGroup","path":"near-common/NearVpc/SSMEndpoint/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-common/NearVpc/SSMEndpoint/SecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"near-common/NearVpc/SSMEndpoint/SecurityGroup","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":{"Fn::GetAtt":["NearVpc17ED9B68","CidrBlock"]},"ipProtocol":"tcp","fromPort":443,"toPort":443,"description":{"Fn::Join":["",["from ",{"Fn::GetAtt":["NearVpc17ED9B68","CidrBlock"]},":443"]]}}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}}}},"Resource":{"id":"Resource","path":"near-common/NearVpc/SSMEndpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}],"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["NearVpcSSMEndpointSecurityGroup331F7B95","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.ssm","subnetIds":[{"Ref":"NearVpcPrivateSubnet1SubnetE647D3D1"},{"Ref":"NearVpcPrivateSubnet2SubnetDDB4FE3B"}],"vpcEndpointType":"Interface","vpcId":{"Ref":"NearVpc17ED9B68"}}}}}},"SSMMessagesEndpoint":{"id":"SSMMessagesEndpoint","path":"near-common/NearVpc/SSMMessagesEndpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.222.0","metadata":[]},"children":{"SecurityGroup":{"id":"SecurityGroup","path":"near-common/NearVpc/SSMMessagesEndpoint/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-common/NearVpc/SSMMessagesEndpoint/SecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"near-common/NearVpc/SSMMessagesEndpoint/SecurityGroup","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":{"Fn::GetAtt":["NearVpc17ED9B68","CidrBlock"]},"ipProtocol":"tcp","fromPort":443,"toPort":443,"description":{"Fn::Join":["",["from ",{"Fn::GetAtt":["NearVpc17ED9B68","CidrBlock"]},":443"]]}}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}}}},"Resource":{"id":"Resource","path":"near-common/NearVpc/SSMMessagesEndpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}],"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["NearVpcSSMMessagesEndpointSecurityGroup1D2CE1B5","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.ssmmessages","subnetIds":[{"Ref":"NearVpcPrivateSubnet1SubnetE647D3D1"},{"Ref":"NearVpcPrivateSubnet2SubnetDDB4FE3B"}],"vpcEndpointType":"Interface","vpcId":{"Ref":"NearVpc17ED9B68"}}}}}},"EC2MessagesEndpoint":{"id":"EC2MessagesEndpoint","path":"near-common/NearVpc/EC2MessagesEndpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.222.0","metadata":[]},"children":{"SecurityGroup":{"id":"SecurityGroup","path":"near-common/NearVpc/EC2MessagesEndpoint/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-common/NearVpc/EC2MessagesEndpoint/SecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"near-common/NearVpc/EC2MessagesEndpoint/SecurityGroup","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":{"Fn::GetAtt":["NearVpc17ED9B68","CidrBlock"]},"ipProtocol":"tcp","fromPort":443,"toPort":443,"description":{"Fn::Join":["",["from ",{"Fn::GetAtt":["NearVpc17ED9B68","CidrBlock"]},":443"]]}}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}}}},"Resource":{"id":"Resource","path":"near-common/NearVpc/EC2MessagesEndpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-common/NearVpc"},{"key":"Project","value":"AWSNearLocalnet"}],"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["NearVpcEC2MessagesEndpointSecurityGroup1BCA66F4","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.ec2messages","subnetIds":[{"Ref":"NearVpcPrivateSubnet1SubnetE647D3D1"},{"Ref":"NearVpcPrivateSubnet2SubnetDDB4FE3B"}],"vpcEndpointType":"Interface","vpcId":{"Ref":"NearVpc17ED9B68"}}}}}}}},"NearNodeSecurityGroup":{"id":"NearNodeSecurityGroup","path":"near-common/NearNodeSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-common/NearNodeSecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"NEAR localnet node security group","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":{"Fn::GetAtt":["NearVpc17ED9B68","CidrBlock"]},"ipProtocol":"tcp","fromPort":3030,"toPort":3030,"description":"Allow NEAR RPC from within VPC"},{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":22,"toPort":22,"description":"SSH access for debugging"}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Ref":"NearVpc17ED9B68"}}}}}},"NearNodeRole":{"id":"NearNodeRole","path":"near-common/NearNodeRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.222.0","metadata":[]},"children":{"ImportNearNodeRole":{"id":"ImportNearNodeRole","path":"near-common/NearNodeRole/ImportNearNodeRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"near-common/NearNodeRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ec2.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonSSMManagedInstanceCore"]]}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"near-common/NearNodeRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-common/NearNodeRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"cloudformation:SignalResource","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"NearNodeRoleDefaultPolicyD9A01D49","roles":[{"Ref":"NearNodeRole5BF1752D"}]}}}}}}},"InstanceRoleArn":{"id":"InstanceRoleArn","path":"near-common/InstanceRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"VpcId":{"id":"VpcId","path":"near-common/VpcId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"SecurityGroupId":{"id":"SecurityGroupId","path":"near-common/SecurityGroupId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"near-common/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"near-common/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"Exports":{"id":"Exports","path":"near-common/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Ref\":\"NearNodeRole5BF1752D\"}":{"id":"Output{\"Ref\":\"NearNodeRole5BF1752D\"}","path":"near-common/Exports/Output{\"Ref\":\"NearNodeRole5BF1752D\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"Output{\"Fn::GetAtt\":[\"NearNodeSecurityGroup8025226D\",\"GroupId\"]}":{"id":"Output{\"Fn::GetAtt\":[\"NearNodeSecurityGroup8025226D\",\"GroupId\"]}","path":"near-common/Exports/Output{\"Fn::GetAtt\":[\"NearNodeSecurityGroup8025226D\",\"GroupId\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"Output{\"Ref\":\"NearVpcPublicSubnet1SubnetD881C8CB\"}":{"id":"Output{\"Ref\":\"NearVpcPublicSubnet1SubnetD881C8CB\"}","path":"near-common/Exports/Output{\"Ref\":\"NearVpcPublicSubnet1SubnetD881C8CB\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"Output{\"Fn::GetAtt\":[\"NearVpc17ED9B68\",\"CidrBlock\"]}":{"id":"Output{\"Fn::GetAtt\":[\"NearVpc17ED9B68\",\"CidrBlock\"]}","path":"near-common/Exports/Output{\"Fn::GetAtt\":[\"NearVpc17ED9B68\",\"CidrBlock\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"Output{\"Ref\":\"NearVpc17ED9B68\"}":{"id":"Output{\"Ref\":\"NearVpc17ED9B68\"}","path":"near-common/Exports/Output{\"Ref\":\"NearVpc17ED9B68\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"Output{\"Ref\":\"NearVpcPrivateSubnet1SubnetE647D3D1\"}":{"id":"Output{\"Ref\":\"NearVpcPrivateSubnet1SubnetE647D3D1\"}","path":"near-common/Exports/Output{\"Ref\":\"NearVpcPrivateSubnet1SubnetE647D3D1\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"Output{\"Ref\":\"NearVpcPrivateSubnet2SubnetDDB4FE3B\"}":{"id":"Output{\"Ref\":\"NearVpcPrivateSubnet2SubnetDDB4FE3B\"}","path":"near-common/Exports/Output{\"Ref\":\"NearVpcPrivateSubnet2SubnetDDB4FE3B\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"near-common/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.222.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"near-common/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.222.0"}}}},"near-infrastructure":{"id":"near-infrastructure","path":"near-infrastructure","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.222.0"},"children":{"NearLocalnetNodeV2101":{"id":"NearLocalnetNodeV2101","path":"near-infrastructure/NearLocalnetNodeV2101","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Instance","version":"2.222.0","metadata":[]},"children":{"InstanceProfile":{"id":"InstanceProfile","path":"near-infrastructure/NearLocalnetNodeV2101/InstanceProfile","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnInstanceProfile","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::InstanceProfile","aws:cdk:cloudformation:props":{"roles":[{"Fn::ImportValue":"near-localnet-common:ExportsOutputRefNearNodeRole5BF1752D644CF4FE"}]}}},"Resource":{"id":"Resource","path":"near-infrastructure/NearLocalnetNodeV2101/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInstance","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Instance","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1a","blockDeviceMappings":[{"deviceName":"/dev/sda1","ebs":{"deleteOnTermination":true,"volumeSize":30,"volumeType":"gp3"}}],"iamInstanceProfile":{"Ref":"NearLocalnetNodeV2101InstanceProfile1AF7AF63"},"imageId":{"Ref":"SsmParameterValueawsservicecanonicalubuntuserver2404stablecurrentamd64hvmebsgp3amiidC96584B6F00A464EAD1953AFF4B05118Parameter"},"instanceType":"t3.large","securityGroupIds":[{"Fn::ImportValue":"near-localnet-common:ExportsOutputFnGetAttNearNodeSecurityGroup8025226DGroupId38AA7018"}],"subnetId":{"Fn::ImportValue":"near-localnet-common:ExportsOutputRefNearVpcPublicSubnet1SubnetD881C8CB152738DF"},"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Name","value":"near-infrastructure/NearLocalnetNodeV2101"},{"key":"NearVersion","value":"2.10.1"},{"key":"Project","value":"AWSNearLocalnet"}],"userData":{"Fn::Base64":"#!/bin/bash\n#!/bin/bash\nset -e\nexec > >(tee /var/log/near-setup.log) 2>&1\n\n# Update system\napt update\n\n# Install dependencies for NEAR compilation (Ubuntu packages)\napt install -y git binutils-dev libcurl4-openssl-dev zlib1g-dev libdw-dev libiberty-dev cmake gcc g++ python3 python3-pip protobuf-compiler libssl-dev pkg-config clang llvm\n\n# Install Rust as ubuntu user\nsu - ubuntu -c \"curl --proto =https --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\"\nsu - ubuntu -c \"source ~/.cargo/env && rustc --version\"\n\n# Clone nearcore\nsu - ubuntu -c \"cd ~ && git clone https://github.com/near/nearcore.git\"\nsu - ubuntu -c \"cd ~/nearcore && git checkout 2.10.1\"\n\n# Compile neard (takes ~10-15 minutes)\nsu - ubuntu -c \"cd ~/nearcore && source ~/.cargo/env && make neard\"\n\n# Install nearup (Ubuntu 24.04 requires --break-system-packages)\nsu - ubuntu -c \"pip3 install --user --break-system-packages nearup\"\n\n# Run nearup localnet with compiled binary\nsu - ubuntu -c \"export PATH=$PATH:~/.local/bin && nearup run localnet --binary-path ~/nearcore/target/release\" > /var/log/nearup.log 2>&1 &\n\n# Wait for NEAR to initialize\nsleep 60\n\necho \"NEAR localnet initialization complete\" > /var/log/near-init-complete.log"}}}}}},"SsmParameterValue:--aws--service--canonical--ubuntu--server--24.04--stable--current--amd64--hvm--ebs-gp3--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--aws--service--canonical--ubuntu--server--24.04--stable--current--amd64--hvm--ebs-gp3--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"near-infrastructure/SsmParameterValue:--aws--service--canonical--ubuntu--server--24.04--stable--current--amd64--hvm--ebs-gp3--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.222.0"}},"SsmParameterValue:--aws--service--canonical--ubuntu--server--24.04--stable--current--amd64--hvm--ebs-gp3--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--aws--service--canonical--ubuntu--server--24.04--stable--current--amd64--hvm--ebs-gp3--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"near-infrastructure/SsmParameterValue:--aws--service--canonical--ubuntu--server--24.04--stable--current--amd64--hvm--ebs-gp3--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"near-instance-id":{"id":"near-instance-id","path":"near-infrastructure/near-instance-id","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"near-instance-private-ip":{"id":"near-instance-private-ip","path":"near-infrastructure/near-instance-private-ip","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"near-instance-public-ip":{"id":"near-instance-public-ip","path":"near-infrastructure/near-instance-public-ip","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"near-infrastructure/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"near-infrastructure/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"near-infrastructure/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.222.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"near-infrastructure/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.222.0"}}}},"near-install":{"id":"near-install","path":"near-install","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.222.0"},"children":{"near-validate-install":{"id":"near-validate-install","path":"near-install/near-validate-install","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnDocument","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Document","aws:cdk:cloudformation:props":{"content":{"schemaVersion":"2.2","description":"Validate NEAR localnet installation is complete","parameters":{"nearVersion":{"type":"String","description":"NEAR Protocol version to validate","default":"2.10.1"},"nearNetwork":{"type":"String","description":"NEAR network","default":"localnet"}},"mainSteps":[{"action":"aws:runShellScript","name":"waitForInstallComplete","inputs":{"timeoutSeconds":"900","runCommand":["#!/bin/bash","set -euo pipefail","echo '[INSTALL-STACK] Waiting for NEAR installation to complete...'","source /etc/near-environment || true","","# Check if initialization log exists (created by UserData)","MAX_WAIT=900  # 15 minutes","ELAPSED=0","while [ ! -f /var/log/near-init-complete.log ] && [ $ELAPSED -lt $MAX_WAIT ]; do","  echo '[INSTALL-STACK] Waiting for installation... ($ELAPSED seconds)'","  sleep 30","  ELAPSED=$((ELAPSED + 30))","done","","if [ ! -f /var/log/near-init-complete.log ]; then","  echo '[INSTALL-STACK] ERROR: Installation timeout'","  exit 1","fi","","# Check if neard binary exists","if [ ! -f ~ubuntu/nearcore/target/release/neard ]; then","  echo '[INSTALL-STACK] ERROR: neard binary not found'","  exit 1","fi","","# Check if nearup is installed","if ! command -v ~ubuntu/.local/bin/nearup &> /dev/null; then","  echo '[INSTALL-STACK] ERROR: nearup not found'","  exit 1","fi","","echo '[INSTALL-STACK] Installation validation complete'","echo '[INSTALL-STACK] NEAR localnet is ready'"]}}]},"documentFormat":"YAML","documentType":"Command","name":"near-validate-install-near-localnet-install","tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"near-validate-execution":{"id":"near-validate-execution","path":"near-install/near-validate-execution","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnAssociation","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Association","aws:cdk:cloudformation:props":{"applyOnlyAtCronInterval":false,"maxConcurrency":"1","maxErrors":"0","name":{"Ref":"nearvalidateinstall"},"parameters":{"nearVersion":["2.10.1"],"nearNetwork":["localnet"]},"targets":[{"key":"InstanceIds","values":[{"Fn::ImportValue":"NearLocalnetInstanceId"}]}]}}},"install-document-name":{"id":"install-document-name","path":"near-install/install-document-name","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"install-status":{"id":"install-status","path":"near-install/install-status","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"near-install/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"near-install/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"near-install/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.222.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"near-install/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.222.0"}}}},"near-sync":{"id":"near-sync","path":"near-sync","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.222.0"},"children":{"near-validate-service":{"id":"near-validate-service","path":"near-sync/near-validate-service","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnDocument","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Document","aws:cdk:cloudformation:props":{"content":{"schemaVersion":"2.2","description":"Validate NEAR localnet service is running","parameters":{"nearNetwork":{"type":"String","description":"NEAR network","default":"localnet"}},"mainSteps":[{"action":"aws:runShellScript","name":"validateServiceRunning","inputs":{"timeoutSeconds":"300","runCommand":["#!/bin/bash","set -euo pipefail","echo '[SYNC-STACK] Validating NEAR localnet service...'","","# Check if nearup process is running","if ! pgrep -f 'nearup' > /dev/null; then","  echo '[SYNC-STACK] ERROR: nearup process not found'","  exit 1","fi","","# Wait for RPC endpoint to be available","MAX_WAIT=300","ELAPSED=0","while [ $ELAPSED -lt $MAX_WAIT ]; do","  if curl -s http://127.0.0.1:3030/status > /dev/null 2>&1; then","    echo '[SYNC-STACK] RPC endpoint is available'","    break","  fi","  echo '[SYNC-STACK] Waiting for RPC endpoint... ($ELAPSED seconds)'","  sleep 10","  ELAPSED=$((ELAPSED + 10))","done","","# Final check","if ! curl -s http://127.0.0.1:3030/status > /dev/null 2>&1; then","  echo '[SYNC-STACK] ERROR: RPC endpoint not available after $MAX_WAIT seconds'","  exit 1","fi","","# Get status for verification","STATUS=$(curl -s http://127.0.0.1:3030/status | jq -r '.chain_id // \"unknown\"')","echo '[SYNC-STACK] NEAR localnet chain_id: $STATUS'","echo '[SYNC-STACK] Service validation complete'"]}}]},"documentFormat":"YAML","documentType":"Command","name":"near-validate-service-near-localnet-sync","tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"near-validate-service-execution":{"id":"near-validate-service-execution","path":"near-sync/near-validate-service-execution","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnAssociation","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Association","aws:cdk:cloudformation:props":{"applyOnlyAtCronInterval":false,"maxConcurrency":"1","maxErrors":"0","name":{"Ref":"nearvalidateservice"},"parameters":{"nearNetwork":["localnet"]},"targets":[{"key":"InstanceIds","values":[{"Fn::ImportValue":"NearLocalnetInstanceId"}]}]}}},"near-localnet-dashboard":{"id":"near-localnet-dashboard","path":"near-sync/near-localnet-dashboard","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Dashboard","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-sync/near-localnet-dashboard/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnDashboard","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Dashboard","aws:cdk:cloudformation:props":{"dashboardBody":{"Fn::Join":["",["{\"widgets\":[{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Instance Status\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/EC2\",\"CPUUtilization\",\"InstanceId\",\"",{"Fn::ImportValue":"NearLocalnetInstanceId"},"\"],[\"AWS/EC2\",\"NetworkIn\",\"InstanceId\",\"",{"Fn::ImportValue":"NearLocalnetInstanceId"},"\",{\"stat\":\"Sum\",\"yAxis\":\"right\"}],[\"AWS/EC2\",\"NetworkOut\",\"InstanceId\",\"",{"Fn::ImportValue":"NearLocalnetInstanceId"},"\",{\"stat\":\"Sum\",\"yAxis\":\"right\"}]],\"yAxis\":{}}}]}"]]},"dashboardName":"near-localnet-near-localnet-sync"}}}}},"sync-status":{"id":"sync-status","path":"near-sync/sync-status","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"near-rpc-url":{"id":"near-rpc-url","path":"near-sync/near-rpc-url","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"near-network-id":{"id":"near-network-id","path":"near-sync/near-network-id","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"near-sync/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"near-sync/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"near-sync/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.222.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"near-sync/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.222.0"}}}},"near-test":{"id":"near-test","path":"near-test","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.222.0"},"children":{"TestLogGroup":{"id":"TestLogGroup","path":"near-test/TestLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-test/TestLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":"/aws/lambda/near-localnet-test","retentionInDays":7,"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}]}}}}},"TestLambdaRole":{"id":"TestLambdaRole","path":"near-test/TestLambdaRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.222.0","metadata":[]},"children":{"ImportTestLambdaRole":{"id":"ImportTestLambdaRole","path":"near-test/TestLambdaRole/ImportTestLambdaRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"near-test/TestLambdaRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"]]}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"near-test/TestLambdaRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-test/TestLambdaRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"cloudwatch:PutMetricData","Condition":{"StringEquals":{"cloudwatch:namespace":"NEAR/Test"}},"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"TestLambdaRoleDefaultPolicy7616C22F","roles":[{"Ref":"TestLambdaRoleC771CE80"}]}}}}}}},"TestLambdaSecurityGroup":{"id":"TestLambdaSecurityGroup","path":"near-test/TestLambdaSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-test/TestLambdaSecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for NEAR test Lambda function","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":{"Fn::ImportValue":"near-localnet-common:ExportsOutputFnGetAttNearVpc17ED9B68CidrBlock50BFD339"},"ipProtocol":"tcp","fromPort":3030,"toPort":3030,"description":"Allow access to NEAR RPC endpoint"}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}],"vpcId":{"Fn::ImportValue":"near-localnet-common:ExportsOutputRefNearVpc17ED9B68D255C35F"}}}}}},"TestFunction":{"id":"TestFunction","path":"near-test/TestFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.222.0","metadata":[]},"children":{"Code":{"id":"Code","path":"near-test/TestFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.222.0"},"children":{"Stage":{"id":"Stage","path":"near-test/TestFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.222.0"}},"AssetBucket":{"id":"AssetBucket","path":"near-test/TestFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.222.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"near-test/TestFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-311843862895-us-east-1","s3Key":"0e8836d427fb79645b35228f7fd417c73c8f91f680ce623dc22caa4b2c8e2eba.zip"},"environment":{"variables":{"RPC_URL":{"Fn::Join":["",["http://",{"Fn::ImportValue":"NearLocalnetInstancePrivateIp"},":3030"]]},"NETWORK_ID":"localnet","INCLUDE_WRITE_TESTS":"false","TEST_DEPTH":"basic","INSTANCE_ID":{"Fn::ImportValue":"NearLocalnetInstanceId"},"VALIDATOR_KEY_JSON":""}},"functionName":"near-localnet-test","handler":"handler.handler","loggingConfig":{"logGroup":{"Ref":"TestLogGroup4EEF7AD4"}},"memorySize":512,"role":{"Fn::GetAtt":["TestLambdaRoleC771CE80","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}],"timeout":600,"vpcConfig":{"subnetIds":[{"Fn::ImportValue":"near-localnet-common:ExportsOutputRefNearVpcPrivateSubnet1SubnetE647D3D15F5DCF9E"},{"Fn::ImportValue":"near-localnet-common:ExportsOutputRefNearVpcPrivateSubnet2SubnetDDB4FE3B206BEA24"}],"securityGroupIds":[{"Fn::GetAtt":["TestLambdaSecurityGroupB2333BAC","GroupId"]}]}}}}}},"NearTestTrigger":{"id":"NearTestTrigger","path":"near-test/NearTestTrigger","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnDocument","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Document","aws:cdk:cloudformation:props":{"content":{"schemaVersion":"2.2","description":"Trigger NEAR localnet functional tests via Lambda","parameters":{"functionArn":{"type":"String","description":"Lambda function ARN","default":{"Fn::GetAtt":["TestFunction22AD90FC","Arn"]}},"includeWriteTests":{"type":"String","description":"Include write tests","default":"false"},"testDepth":{"type":"String","description":"Test depth (basic or comprehensive)","default":"basic"}},"mainSteps":[{"action":"aws:runShellScript","name":"invokeTestLambda","inputs":{"timeoutSeconds":"600","runCommand":["#!/bin/bash","set -euo pipefail","echo '[TEST-TRIGGER] Invoking test Lambda function...'","","FUNCTION_ARN=\"{{functionArn}}\"","INCLUDE_WRITE_TESTS=\"{{includeWriteTests}}\"","TEST_DEPTH=\"{{testDepth}}\"","","# Invoke Lambda function","RESPONSE=$(aws lambda invoke \\","  --function-name \"$FUNCTION_ARN\" \\","  --payload \"{\\\"includeWriteTests\\\": \\\"$INCLUDE_WRITE_TESTS\\\", \\\"testDepth\\\": \\\"$TEST_DEPTH\\\"}\" \\","  --cli-binary-format raw-in-base64-out \\","  /tmp/lambda-response.json 2>&1)","","if [ $? -ne 0 ]; then","  echo '[TEST-TRIGGER] ERROR: Failed to invoke Lambda'","  echo \"$RESPONSE\"","  exit 1","fi","","# Check Lambda response","if [ -f /tmp/lambda-response.json ]; then","  EXIT_CODE=$(jq -r '.FunctionError // empty' /tmp/lambda-response.json || echo '')","  if [ -n \"$EXIT_CODE\" ]; then","    echo '[TEST-TRIGGER] ERROR: Lambda function error'","    cat /tmp/lambda-response.json","    exit 1","  fi","fi","","# Wait for Lambda to complete and check logs","echo '[TEST-TRIGGER] Waiting for test completion...'","sleep 30","","# Get test results from logs","echo '[TEST-TRIGGER] Test execution completed'","echo '[TEST-TRIGGER] Check CloudWatch Logs for detailed results'","","exit 0"]}}]},"documentFormat":"YAML","documentType":"Command","name":"near-test-trigger-near-localnet-test","tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}]}}},"TestCustomResource":{"id":"TestCustomResource","path":"near-test/TestCustomResource","constructInfo":{"fqn":"aws-cdk-lib.custom_resources.AwsCustomResource","version":"2.222.0"},"children":{"Provider":{"id":"Provider","path":"near-test/TestCustomResource/Provider","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"near-test/TestCustomResource/Resource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.222.0","metadata":[]},"children":{"Default":{"id":"Default","path":"near-test/TestCustomResource/Resource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"CustomResourcePolicy":{"id":"CustomResourcePolicy","path":"near-test/TestCustomResource/CustomResourcePolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-test/TestCustomResource/CustomResourcePolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":{"Fn::GetAtt":["TestFunction22AD90FC","Arn"]}}],"Version":"2012-10-17"},"policyName":"TestCustomResourceCustomResourcePolicy0CDB19D4","roles":[{"Ref":"AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"}]}}}}}}},"AWS679f53fac002430cb0da5b7982bd2287":{"id":"AWS679f53fac002430cb0da5b7982bd2287","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.222.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.222.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}]}}}}},"Code":{"id":"Code","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.222.0"},"children":{"Stage":{"id":"Stage","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.222.0"}},"AssetBucket":{"id":"AssetBucket","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.222.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"near-test/AWS679f53fac002430cb0da5b7982bd2287/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-311843862895-us-east-1","s3Key":"8d5e97812d0036272ba1fd5bb8772ff51f4712e58c75507e4a0db242bf680f1d.zip"},"handler":"index.handler","role":{"Fn::GetAtt":["AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2","Arn"]},"runtime":"nodejs22.x","tags":[{"key":"Architecture","value":"MultiStack"},{"key":"Project","value":"AWSNearLocalnet"}],"timeout":600}}}}},"TestDashboard":{"id":"TestDashboard","path":"near-test/TestDashboard","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Dashboard","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"near-test/TestDashboard/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnDashboard","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Dashboard","aws:cdk:cloudformation:props":{"dashboardBody":{"Fn::Join":["",["{\"widgets\":[{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Test Execution Results\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"NEAR/Test\",\"TestsPassed\",\"FunctionName\",\"",{"Ref":"TestFunction22AD90FC"},"\",{\"label\":\"Tests Passed\",\"stat\":\"Sum\"}],[\"NEAR/Test\",\"TestsFailed\",\"FunctionName\",\"",{"Ref":"TestFunction22AD90FC"},"\",{\"color\":\"#d62728\",\"label\":\"Tests Failed\",\"stat\":\"Sum\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":6,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Test Duration & RPC Performance\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"NEAR/Test\",\"TestDuration\",\"FunctionName\",\"",{"Ref":"TestFunction22AD90FC"},"\",{\"label\":\"Test Duration (ms)\"}],[\"NEAR/Test\",\"RpcResponseTime\",\"FunctionName\",\"",{"Ref":"TestFunction22AD90FC"},"\",{\"label\":\"RPC Response Time (ms)\",\"yAxis\":\"right\"}]],\"yAxis\":{}}}]}"]]},"dashboardName":"near-localnet-test-near-localnet-test"}}}}},"TestLambdaArn":{"id":"TestLambdaArn","path":"near-test/TestLambdaArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"TestSsmDocumentName":{"id":"TestSsmDocumentName","path":"near-test/TestSsmDocumentName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"TestLogGroupName":{"id":"TestLogGroupName","path":"near-test/TestLogGroupName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"TestDashboardUrl":{"id":"TestDashboardUrl","path":"near-test/TestDashboardUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"near-test/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"near-test/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"near-test/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.222.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"near-test/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.222.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}